# ===================================================================
#
#         PowerShell 個人化設定檔 (合併與註解版本)
#         整合了兩個設定檔的功能，並修正了語法問題
#
# ===================================================================


# -------------------------------------------------------------------
# 首次設定 (安裝模組)
# 說明：這些指令只需要執行一次來安裝所需工具。安裝後應保持註解狀態。
# 若要執行，請將該行開頭的 '#' 刪除，然後在 PowerShell 中執行。
# -------------------------------------------------------------------
# Install-Module oh-my-posh -Scope CurrentUser -AllowPrerelease # 安裝主題引擎
# Install-Module -Name Terminal-Icons -Repository PSGallery    # 安裝檔案圖示模組
# Install-Module posh-git                                      # 安裝 Git 狀態整合模組
# Install-Module ZLocation                                     # 安裝智慧目錄跳轉模組


# -------------------------------------------------------------------
# Oh My Posh 主題設定
# 說明：請從以下選項中選擇一個您喜歡的主題，並取消它的註解。
#      一次只能啟用一個主題。這是 Oh My Posh 新版的標準設定方式。
# -------------------------------------------------------------------
# [選擇1 - 來自第一個設定檔] Powerlevel10k Classic 主題
oh-my-posh init pwsh --config "$env:POSH_THEMES_PATH/powerlevel10k_classic.omp.json" | Invoke-Expression

# [選擇2 - 來自第二個設定檔] Paradox 主題
# oh-my-posh init pwsh --config "$env:POSH_THEMES_PATH/paradox.omp.json" | Invoke-Expression


# --- 以下為被註解掉的無效或多餘設定 ---

# 說明：下面這行會載入預設主題，但因為上面已經指定了特定主題，所以這行是多餘的。
# oh-my-posh init pwsh | Invoke-Expression

# 說明：'Set-Theme' 是 Oh My Posh v2 (舊版) 的語法，在新版中已無效，故註解。
# Set-Theme Paradox

# 說明：'$DefaultUser' 也是舊版語法。在新版中，若想隱藏使用者名稱，需要直接修改主題的 .json 檔案。
# $DefaultUser = 'seraphwu'


# -------------------------------------------------------------------
# 載入功能模組
# 說明：在每次啟動 PowerShell 時載入這些模組以啟用它們的功能。
# -------------------------------------------------------------------
# 為 'ls' 或 'dir' 指令提供漂亮的檔案/資料夾圖示
Import-Module -Name Terminal-Icons

# 讓提示字元能顯示當前資料夾的 Git 狀態 (分支、修改等)
Import-Module posh-git

# 啟用智慧目錄跳轉功能，可使用 'z' 指令快速移動到常用目錄
Import-Module ZLocation

# 說明：'Import-Module oh-my-posh' 在新版中通常是不必要的，因為 'init' 命令會處理好。
# Import-Module oh-my-posh


# -------------------------------------------------------------------
# 命令列體驗增強 (PSReadLine)
# 說明：客製化 PowerShell 的輸入與自動補全行為。
# -------------------------------------------------------------------
# 將命令歷史建議從行內灰色文字，改為更方便選取的清單模式 (ListView)
Set-PSReadLineOption -PredictionViewStyle ListView


# -------------------------------------------------------------------
# 其他工具整合
# 說明：整合第三方工具，例如 Scoop。
# -------------------------------------------------------------------
# 如果您使用 Scoop 套件管理器，這行會掛載 scoop-search 的功能，提供更好的搜尋體驗。
Invoke-Expression (&scoop-search --hook)


# -------------------------------------------------------------------
# 設定檔結束
# 重要提醒：
# 1. 字型：為了讓圖示正常顯示，請務必在您的終端機(如 Windows Terminal)
#           設定中，將字型設定為任一款 "Nerd Font" (例如: CaskaydiaCove Nerd Font)。
# 2. 修改：若要修改主題外觀，請直接編輯對應的 .json 檔案，而不是此檔案。
#           可使用 `Get-PoshThemes` 指令找到主題檔案的路徑。
# -------------------------------------------------------------------